---------------------------------------------------------------
## Test to_number func used for order_by for oracle  compatibility
purpose to test the decimal and precision
---------------------------------------------------------------
set @@sql_mode = STRICT_TRANS_TABLES;
Warnings:
Warning	3135	'NO_ZERO_DATE', 'NO_ZERO_IN_DATE' and 'ERROR_FOR_DIVISION_BY_ZERO' sql modes should be used with strict mode. They will be merged with strict mode in a future release.
select @@sql_mode;
@@sql_mode
STRICT_TRANS_TABLES
drop database if exists abczyy_num;
Warnings:
Note	1008	Can't drop database 'abczyy_num'; database doesn't exist
create database abczyy_num;
create table abczyy_num.tb1(a int key, b int);
insert into abczyy_num.tb1(a,b) values(1,1),(2,2),(11,11),(22,22);
---------------------------------------------------------------
## Test_1: test tb1 order by use to_number()
---------------------------------------------------------------
select * from abczyy_num.tb1 order by to_number(b);
a	b
1	1
2	2
11	11
22	22
select * from abczyy_num.tb1 order by to_number(a);
a	b
1	1
2	2
11	11
22	22
select * from abczyy_num.tb1 order by b;
a	b
1	1
2	2
11	11
22	22
select * from abczyy_num.tb1 order by cast(b as decimal);
a	b
1	1
2	2
11	11
22	22
select * from abczyy_num.tb1 order by to_number(a)+1;
a	b
1	1
2	2
11	11
22	22
select * from abczyy_num.tb1 order by to_number(a)+b desc;
a	b
22	22
11	11
2	2
1	1
select * from abczyy_num.tb1 order by to_number(a)*b desc;
a	b
22	22
11	11
2	2
1	1
select * from abczyy_num.tb1 order by to_number(a)*(-1);
a	b
22	22
11	11
2	2
1	1
select * from abczyy_num.tb1 order by ((to_number(a)+1)/1)*(-1);
a	b
22	22
11	11
2	2
1	1
---------------------------------------------------------------
## Test_2: test tb2 order by use to_number()
---------------------------------------------------------------
create table abczyy_num.tb2(a int key, b decimal(65,30));
insert into abczyy_num.tb2(a,b) values(1,1.1),(2,2.2),(11,11.11),(22,22.22);
select * from abczyy_num.tb2 order by to_number(b);
a	b
1	1.100000000000000000000000000000
2	2.200000000000000000000000000000
11	11.110000000000000000000000000000
22	22.220000000000000000000000000000
select * from abczyy_num.tb2 order by to_number(a);
a	b
1	1.100000000000000000000000000000
2	2.200000000000000000000000000000
11	11.110000000000000000000000000000
22	22.220000000000000000000000000000
select * from abczyy_num.tb2 order by to_number(a)+1 desc;
a	b
22	22.220000000000000000000000000000
11	11.110000000000000000000000000000
2	2.200000000000000000000000000000
1	1.100000000000000000000000000000
select * from abczyy_num.tb2 order by to_number(a)+b;
a	b
1	1.100000000000000000000000000000
2	2.200000000000000000000000000000
11	11.110000000000000000000000000000
22	22.220000000000000000000000000000
select * from abczyy_num.tb2 order by to_number(a)*b;
a	b
1	1.100000000000000000000000000000
2	2.200000000000000000000000000000
11	11.110000000000000000000000000000
22	22.220000000000000000000000000000
select * from abczyy_num.tb2 order by to_number(a)*(-1) desc;
a	b
1	1.100000000000000000000000000000
2	2.200000000000000000000000000000
11	11.110000000000000000000000000000
22	22.220000000000000000000000000000
select * from abczyy_num.tb2 order by ((to_number(a)*(-1))/1)*(-1) desc;
a	b
22	22.220000000000000000000000000000
11	11.110000000000000000000000000000
2	2.200000000000000000000000000000
1	1.100000000000000000000000000000
---------------------------------------------------------------
## Test_3: test tb3 order by use to_number()
---------------------------------------------------------------
create table abczyy_num.tb3(a varchar(100) key, b varchar(100));
insert into abczyy_num.tb3(a,b) values('1.1','1.1'),('2.2','2.2'),('11.11','11.11'),('22.22','22.22');
insert into abczyy_num.tb3(a,b) values('111.111','111.111'),('222.222','222.222'),('1111.1111','1111.1111'),('2222.2222','2222.2222');
insert into abczyy_num.tb3(a,b) values('1111111111.1111111111','1111111111.1111111111'),('11111111111111111111.11111111111111111111','11111111111111111111.11111111111111111111');
insert into abczyy_num.tb3(a,b) values('0.2222222222','0.2222222222');
select * from abczyy_num.tb3 order by to_number(b);
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
select * from abczyy_num.tb3 order by to_number(a);
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
select * from abczyy_num.tb3 order by to_number(a)+1;
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
select * from abczyy_num.tb3 order by to_number(a)+b;
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
select * from abczyy_num.tb3 order by to_number(a)*b;
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
select * from abczyy_num.tb3 order by to_number(a)*(-1);
a	b
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
1111111111.1111111111	1111111111.1111111111
2222.2222	2222.2222
1111.1111	1111.1111
222.222	222.222
111.111	111.111
22.22	22.22
11.11	11.11
2.2	2.2
1.1	1.1
0.2222222222	0.2222222222
select * from abczyy_num.tb3 order by ((to_number(a)*(-1))/1)*(-1);
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
insert into abczyy_num.tb3(a,b) values('1234','12345678901234567890123456789012345');
select * from abczyy_num.tb3 order by to_number(b);
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
1234	12345678901234567890123456789012345
select * from abczyy_num.tb3 order by to_number(a);
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
1234	12345678901234567890123456789012345
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
insert into abczyy_num.tb3(a,b) values('12345','123456789012345678901234567890123456');
select * from abczyy_num.tb3 order by to_number(a);
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
1234	12345678901234567890123456789012345
2222.2222	2222.2222
12345	123456789012345678901234567890123456
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
select * from abczyy_num.tb3 order by to_number(b);
ERROR HY000: TO_NUMBER value out of range: smaller precision-decimals
delete from abczyy_num.tb3 where a = '12345';
---------------------------------------------------------------
## Test_4: test sum and order by use to_number()
---------------------------------------------------------------
select * from abczyy_num.tb3 order by if(1,to_number(a),to_number(b))-1;
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
1234	12345678901234567890123456789012345
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
select * from abczyy_num.tb3 order by if(0,to_number(a),to_number(b))-1;
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
1234	12345678901234567890123456789012345
select * from abczyy_num.tb3 order by if(1,to_number(a)+1,to_number(b)+1)-1;
a	b
0.2222222222	0.2222222222
1.1	1.1
2.2	2.2
11.11	11.11
22.22	22.22
111.111	111.111
222.222	222.222
1111.1111	1111.1111
1234	12345678901234567890123456789012345
2222.2222	2222.2222
1111111111.1111111111	1111111111.1111111111
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
select * from abczyy_num.tb3 order by if(0,-1,((to_number(b)+1)*(-1)))-1;
a	b
1234	12345678901234567890123456789012345
11111111111111111111.11111111111111111111	11111111111111111111.11111111111111111111
1111111111.1111111111	1111111111.1111111111
2222.2222	2222.2222
1111.1111	1111.1111
222.222	222.222
111.111	111.111
22.22	22.22
11.11	11.11
2.2	2.2
1.1	1.1
0.2222222222	0.2222222222
---------------------------------------------------------------
## End test to_number function with other functions
---------------------------------------------------------------
drop database if exists abczyy_num;
